# Export STIG from STIG Viewer into CSV
# Remove the below lines (Header/Footer) from the CSV before importing.
# "~~~~~UNCLASSIFIED~~~~~"
$STIG = Import-Csv .\DHSTIGChecker\Config\Windows10.csv

foreach ($Vuln in $STIG) {
    $Path = ".\DHSTIGChecker\Private\Windows10\$($($Vuln.'Vuln ID').Replace('V-','')).ps1"
    New-Item -Path "$Path" -ItemType File -Force
    $VulnContent = @"
<#
Rule Title: $($Vuln.'Rule Title')
Severity: $($Vuln.Severity)
Vuln ID: $($Vuln.'Vuln ID')
STIG ID: $($Vuln.'STIG ID')

Discussion:
$($Vuln.Discussion)


Check Content:
$($Vuln.'Check Content')

#>
"@

Add-Content -Path $Path -Value $VulnContent
}


