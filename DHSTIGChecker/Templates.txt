#----- Not Domain Joined -----
if (!($IsDomainJoined)) {
    Write-Verbose "This check does not apply: Reason - Not Domain-Joined"
    return "Not Applicable"
}

#----- Non-Persistent VDI -----
if ($isVDI) {
    if (!($VDIPersist)) {
        Write-Verbose "This check does not apply: Reason - Non-Persistent VDI"
        return "Not Applicable"
    }
}

#----- Registry Checks -----
#Single Value Check
$Params = @{
    Path          = "HKLM:"
    Name          = ""
    ExpectedValue = 
}

Compare-RegKeyValue @Params


#Value doesn't exist or is Single Value
$Params = @{
    Path          = "HKLM:"
    Name          = ""
    ExpectedValue = 
}

if (!(Test-RegKeyValueExists -Path $Params.Path -Name $Params.Name)) {
    return $true
}

Compare-RegKeyValue @Params


#One of Multiple Check
$Results = @()
$ValidValues = 1, 3, 8

foreach ($Value in $ValidValues) {
    $Params = @{
        Path          = "HKLM:"
        Name          = ""
        ExpectedValue = $Value
    }
    
    $Results += Compare-RegKeyValue @Params
}

if ($Results -contains "Not a Finding") {
    "Not a Finding"
}
else {
    "Open"
}

#----- Audit Settings -----
$Category = ""
$Setting = ""

$AuditSetting = $AuditPolicy | Where-Object {$_.Subcategory -contains "$Category"}
if ($AuditSetting.'Inclusion Setting' -match $Setting) {
    $true
}
else {
    $false
}


#----- Messages -----
Write-Verbose "This check does not apply: Reason - "